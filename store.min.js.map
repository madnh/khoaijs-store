{"version":3,"sources":["store.min.js"],"names":["root","factory","define","amd","dependencies","_","EventEmitter","args","Array","prototype","slice","call","arguments","module","apply","require","specified","Khoai","Store","this","init_data","name","data","isObject","clone","stores","addListener","pushChangeToOtherStores","isEmpty","thisStoreKey","getStoreKey","getData","each","store","change","Object","create","constructor","id","shouldChange","changeSilent","dataName","dataValue","self","value","path","set","old_data","cloneDeep","emitEvent","new_data","triggerChange","get","default_value","hasData","length","hasOwnProperty","connect","Error","storeKey"],"mappings":"CAAC,SAAUA,EAAMC,GACb,GAAsB,kBAAXC,SAAyBA,OAAOC,IAAK,CAC5C,GAAIC,IACA,SACA,wBAGJF,QAAOE,EAAc,SAAUC,EAAGC,GAC9B,GAAIC,GAAOC,MAAMC,UAAUC,MAAMC,KAAKC,WAClCC,EAASZ,EAAQa,MAAM,KAAMP,EAUjC,OARIQ,SAAQC,UAAU,YAClBD,SAAS,WAAY,SAAUE,GAC3BA,EAAMC,MAAQL,IAItBb,EAAKkB,MAAQL,EAENA,QAER,CACH,GAAIA,GAASZ,EACTD,EAAKK,EACJL,EAAKiB,OAASjB,EAAKiB,MAAMX,cAAiBN,EAAKM,aAGhDN,GAAKiB,QACLjB,EAAKiB,MAAMC,MAAQL,GAGvBb,EAAKkB,MAAQL,IAEnBM,KAAM,SAAUd,EAAGC,GAEjB,QAASY,GAAME,GACXd,EAAaK,KAAKQ,MAElBA,KAAKE,KAAO,GACZF,KAAKG,KAAOjB,EAAEkB,SAASH,GAAaf,EAAEmB,MAAMJ,MAC5CD,KAAKM,UAELN,KAAKO,YAAY,SAAUC,EAAyB,KAkGxD,QAASA,KACL,IAAItB,EAAEuB,QAAQT,KAAKM,QAAnB,CAIA,GAAII,GAAeV,KAAKW,cACpBR,EAAOH,KAAKY,SAEhB1B,GAAE2B,KAAKb,KAAKM,OAAQ,SAAUQ,GAC1BA,EAAMC,OAAOL,EAAcP,MAKnC,MA7GAJ,GAAMT,UAAY0B,OAAOC,OAAO9B,EAAaG,WAC7CS,EAAMT,UAAU4B,YAAcnB,EAE9BA,EAAMT,UAAUqB,YAAc,WAC1B,MAAOX,MAAKE,MAAQF,KAAKmB,IAE7BpB,EAAMT,UAAU8B,aAAe,WAC3B,OAAO,GAEXrB,EAAMT,UAAU+B,aAAe,SAAUC,EAAUC,GAC/C,GAAIC,GAAOxB,KACPG,IAEAjB,GAAEkB,SAASkB,GACXnB,EAAOmB,EAEPnB,EAAKmB,GAAYC,EAGrBrC,EAAE2B,KAAKV,EAAM,SAAUsB,EAAOC,GAC1BxC,EAAEyC,IAAIH,EAAKrB,KAAMuB,EAAMD,MAI/B1B,EAAMT,UAAUyB,OAAS,SAAUO,EAAUC,GACzC,GAAIK,GAAW1C,EAAE2C,UAAU7B,KAAKG,KAEhCH,MAAKqB,aAAa1B,MAAMK,KAAMP,WAE1BO,KAAKoB,gBACLpB,KAAK8B,UAAU,UACXF,SAAUA,EACVG,SAAU/B,KAAKY,aAK3Bb,EAAMT,UAAU0C,cAAgB,WAC5B,GAAI7B,GAAOH,KAAKY,SAEhBZ,MAAK8B,UAAU,UACXF,SAAU1C,EAAE2C,UAAU1B,GACtB4B,SAAU7C,EAAE2C,UAAU1B,MAI9BJ,EAAMT,UAAUsB,QAAU,WACtB,MAAO1B,GAAE2C,UAAU7B,KAAKG,OAS5BJ,EAAMT,UAAU2C,IAAM,SAAU/B,EAAMgC,GAClC,GAAIlC,KAAKmC,QAAQjC,GAAO,CACpB,GAAIuB,GAAQzB,KAAKG,KAAKD,EAEtB,OAAOhB,GAAEkB,SAASqB,GAASvC,EAAE2C,UAAUJ,GAASA,EAGpD,MAAOhC,WAAU2C,OAAS,EAAIF,EAAgB,MAOlDnC,EAAMT,UAAU6C,QAAU,SAAUjC,GAChC,MAAOF,MAAKG,KAAKkC,eAAenC,IAOpCH,EAAMT,UAAUgD,QAAU,SAAUxB,GAChC,KAAMA,YAAiBf,IACnB,KAAM,IAAIwC,OAAM,0CAGpB,IAAIC,GAAW1B,EAAMH,aAErB,QAAIX,KAAKM,OAAO+B,eAAeG,KAI/BxC,KAAKM,OAAOkC,GAAY1B,EACxBd,KAAK8B,UAAU,gBAAiBU,EAAU1B,IAEnC,IAiBJf","file":"store.min.js","sourcesContent":["!function(t,e){if(\"function\"==typeof define&&define.amd){var n=[\"lodash\",\"khoaijs-event-emitter\"];define(n,function(n,o){var i=Array.prototype.slice.call(arguments),a=e.apply(null,i);return require.specified(\"khoaijs\")&&require([\"khoaijs\"],function(t){t.Store=a}),t.Store=a,a})}else{var o=e(t._,t.Khoai&&t.Khoai.EventEmitter||t.EventEmitter);t.Khoai&&(t.Khoai.Store=o),t.Store=o}}(this,function(t,e){function n(n){e.call(this),this.name=\"\",this.data=t.isObject(n)?t.clone(n):{},this.stores={},this.addListener(\"change\",o,1e3)}function o(){if(!t.isEmpty(this.stores)){var e=this.getStoreKey(),n=this.getData();t.each(this.stores,function(t){t.change(e,n)})}}return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype.getStoreKey=function(){return this.name||this.id},n.prototype.shouldChange=function(){return!0},n.prototype.changeSilent=function(e,n){var o=this,i={};if(t.isString(e))i[e]=n;else{if(!t.isPlainObject(e))throw new Error(\"Cannot detect what data to update: \"+e);i=e}t.each(i,function(e,n){t.set(o.data,n,e)})},n.prototype.change=function(e,n){var o=t.cloneDeep(this.data);this.changeSilent.apply(this,arguments),this.shouldChange()&&this.emitEvent(\"change\",{old_data:o,new_data:this.getData()})},n.prototype.triggerChange=function(){var e=this.getData();this.emitEvent(\"change\",{old_data:t.cloneDeep(e),new_data:t.cloneDeep(e)})},n.prototype.getData=function(){return t.cloneDeep(this.data)},n.prototype.get=function(e,n){if(this.hasData(e)){var o=this.data[e];return t.isObject(o)?t.cloneDeep(o):o}return arguments.length>1?n:null},n.prototype.hasData=function(t){return this.data.hasOwnProperty(t)},n.prototype.connect=function(t){if(!(t instanceof n))throw new Error(\"Target store isn't an instance of Store\");var e=t.getStoreKey();return!this.stores.hasOwnProperty(e)&&(this.stores[e]=t,this.emitEvent(\"connect_store\",e,t),!0)},n});\n//# sourceMappingURL=store.min.js.map\n"]}