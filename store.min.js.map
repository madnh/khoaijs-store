{"version":3,"sources":["store.min.js"],"names":["root","factory","define","amd","dependencies","_","EventEmitter","args","Array","prototype","slice","call","arguments","module","apply","require","specified","Khoai","Store","this","init_data","name","data","isObject","clone","stores","addListener","pushChangeToOtherStores","isEmpty","thisStoreKey","getStoreKey","getData","each","store","change","Object","create","constructor","id","shouldChange","changeSilent","dataName","dataValue","self","isString","isPlainObject","Error","value","path","set","old_data","cloneDeep","emitEvent","new_data","triggerChange","get","default_value","hasOwnProperty","connect","storeKey"],"mappings":"CAAC,SAAUA,EAAMC,GACb,GAAsB,kBAAXC,SAAyBA,OAAOC,IAAK,CAC5C,GAAIC,IACA,SACA,wBAGJF,QAAOE,EAAc,SAAUC,EAAGC,GAC9B,GAAIC,GAAOC,MAAMC,UAAUC,MAAMC,KAAKC,WAClCC,EAASZ,EAAQa,MAAM,KAAMP,EAUjC,OARIQ,SAAQC,UAAU,YAClBD,SAAS,WAAY,SAAUE,GAC3BA,EAAMC,MAAQL,IAItBb,EAAKkB,MAAQL,EAENA,QAER,CACH,GAAIA,GAASZ,EACTD,EAAKK,EACJL,EAAKiB,OAASjB,EAAKiB,MAAMX,cAAiBN,EAAKM,aAGhDN,GAAKiB,QACLjB,EAAKiB,MAAMC,MAAQL,GAGvBb,EAAKkB,MAAQL,IAEnBM,KAAM,SAAUd,EAAGC,GAEjB,QAASY,GAAME,GACXd,EAAaK,KAAKQ,MAElBA,KAAKE,KAAO,GACZF,KAAKG,KAAOjB,EAAEkB,SAASH,GAAaf,EAAEmB,MAAMJ,MAC5CD,KAAKM,UAELN,KAAKO,YAAY,SAAUC,EAAyB,KA4FxD,QAASA,KACL,IAAItB,EAAEuB,QAAQT,KAAKM,QAAnB,CAIA,GAAII,GAAeV,KAAKW,cACpBR,EAAOH,KAAKY,SAEhB1B,GAAE2B,KAAKb,KAAKM,OAAQ,SAAUQ,GAC1BA,EAAMC,OAAOL,EAAcP,MAKnC,MAvGAJ,GAAMT,UAAY0B,OAAOC,OAAO9B,EAAaG,WAC7CS,EAAMT,UAAU4B,YAAcnB,EAE9BA,EAAMT,UAAUqB,YAAc,WAC1B,MAAOX,MAAKE,MAAQF,KAAKmB,IAE7BpB,EAAMT,UAAU8B,aAAe,WAC3B,OAAO,GAEXrB,EAAMT,UAAU+B,aAAe,SAAUC,EAAUC,GAC/C,GAAIC,GAAOxB,KACPG,IAEJ,IAAIjB,EAAEuC,SAASH,GACXnB,EAAKmB,GAAYC,MACd,CAAA,IAAIrC,EAAEwC,cAAcJ,GAGvB,KAAM,IAAIK,OAAM,sCAAwCL,EAFxDnB,GAAOmB,EAKXpC,EAAE2B,KAAKV,EAAM,SAAUyB,EAAOC,GAC1B3C,EAAE4C,IAAIN,EAAKrB,KAAM0B,EAAMD,MAI/B7B,EAAMT,UAAUyB,OAAS,SAAUO,EAAUC,GACzC,GAAIQ,GAAW7C,EAAE8C,UAAUhC,KAAKG,KAEhCH,MAAKqB,aAAa1B,MAAMK,KAAMP,WAE1BO,KAAKoB,gBACLpB,KAAKiC,UAAU,UACXF,SAAUA,EACVG,SAAUlC,KAAKY,aAK3Bb,EAAMT,UAAU6C,cAAgB,WAC5B,GAAIhC,GAAOH,KAAKY,SAEhBZ,MAAKiC,UAAU,UACXF,SAAU7C,EAAE8C,UAAU7B,GACtB+B,SAAUhD,EAAE8C,UAAU7B,MAI9BJ,EAAMT,UAAUsB,QAAU,WACtB,MAAO1B,GAAE8C,UAAUhC,KAAKG,OAS5BJ,EAAMT,UAAU8C,IAAM,SAAUlC,EAAMmC,GAClC,GAAIrC,KAAKG,KAAKmC,eAAepC,GAAO,CAChC,GAAI0B,GAAQ5B,KAAKG,KAAKD,EAEtB,OAAOhB,GAAEkB,SAASwB,GAAS1C,EAAE8C,UAAUJ,GAASA,EAGpD,MAAOS,IAAiB,MAO5BtC,EAAMT,UAAUiD,QAAU,SAAUzB,GAChC,KAAMA,YAAiBf,IACnB,KAAM,IAAI4B,OAAM,0CAGpB,IAAIa,GAAW1B,EAAMH,aAErB,QAAIX,KAAKM,OAAOgC,eAAeE,KAI/BxC,KAAKM,OAAOkC,GAAY1B,EACxBd,KAAKiC,UAAU,gBAAiBO,EAAU1B,IAEnC,IAiBJf","file":"store.min.js","sourcesContent":["!function(t,e){if(\"function\"==typeof define&&define.amd){var n=[\"lodash\",\"khoaijs-event-emitter\"];define(n,function(n,o){var i=Array.prototype.slice.call(arguments),r=e.apply(null,i);return require.specified(\"khoaijs\")&&require([\"khoaijs\"],function(t){t.Store=r}),t.Store=r,r})}else{var o=e(t._,t.Khoai&&t.Khoai.EventEmitter||t.EventEmitter);t.Khoai&&(t.Khoai.Store=o),t.Store=o}}(this,function(t,e){function n(n){e.call(this),this.name=\"\",this.data=t.isObject(n)?t.clone(n):{},this.stores={},this.addListener(\"change\",o,1e3)}function o(){if(!t.isEmpty(this.stores)){var e=this.getStoreKey(),n=this.getData();t.each(this.stores,function(t){t.change(e,n)})}}return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype.getStoreKey=function(){return this.name||this.id},n.prototype.shouldChange=function(){return!0},n.prototype.changeSilent=function(e,n){var o=this,i={};if(t.isString(e))i[e]=n;else{if(!t.isPlainObject(e))throw new Error(\"Cannot detect what data to update: \"+e);i=e}t.each(i,function(e,n){t.set(o.data,n,e)})},n.prototype.change=function(e,n){var o=t.cloneDeep(this.data);this.changeSilent.apply(this,arguments),this.shouldChange()&&this.emitEvent(\"change\",{old_data:o,new_data:this.getData()})},n.prototype.triggerChange=function(){var e=this.getData();this.emitEvent(\"change\",{old_data:t.cloneDeep(e),new_data:t.cloneDeep(e)})},n.prototype.getData=function(){return t.cloneDeep(this.data)},n.prototype.get=function(e,n){if(this.data.hasOwnProperty(e)){var o=this.data[e];return t.isObject(o)?t.cloneDeep(o):o}return n||null},n.prototype.connect=function(t){if(!(t instanceof n))throw new Error(\"Target store isn't an instance of Store\");var e=t.getStoreKey();return!this.stores.hasOwnProperty(e)&&(this.stores[e]=t,this.emitEvent(\"connect_store\",e,t),!0)},n});\n//# sourceMappingURL=store.min.js.map\n"]}