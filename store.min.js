!function(t,e){if("function"==typeof define&&define.amd){var n=["lodash","khoaijs-event-emitter"];define(n,function(n,o){var i=Array.prototype.slice.call(arguments),a=e.apply(null,i);return require.specified("khoaijs")&&require(["khoaijs"],function(t){t.Store=a}),t.Store=a,a})}else{var o=e(t._,t.Khoai&&t.Khoai.EventEmitter||t.EventEmitter);t.Khoai&&(t.Khoai.Store=o),t.Store=o}}(this,function(t,e){function n(n){e.call(this),this.name="",this.data=t.isObject(n)?t.clone(n):{},this.stores={},this.addListener("change",o,1e3)}function o(){if(!t.isEmpty(this.stores)){var e=this.getStoreKey(),n=this.getData();t.each(this.stores,function(t){t.change(e,n)})}}return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype.getStoreKey=function(){return this.name||this.id},n.prototype.shouldChange=function(){return!0},n.prototype.changeSilent=function(e,n){var o=this,i={};if(t.isString(e))i[e]=n;else{if(!t.isPlainObject(e))throw new Error("Cannot detect what data to update: "+e);i=e}t.each(i,function(e,n){t.set(o.data,n,e)})},n.prototype.change=function(e,n){var o=t.cloneDeep(this.data);this.changeSilent.apply(this,arguments),this.shouldChange()&&this.emitEvent("change",{old_data:o,new_data:this.getData()})},n.prototype.triggerChange=function(){var e=this.getData();this.emitEvent("change",{old_data:t.cloneDeep(e),new_data:t.cloneDeep(e)})},n.prototype.getData=function(){return t.cloneDeep(this.data)},n.prototype.get=function(e,n){if(this.hasData(e)){var o=this.data[e];return t.isObject(o)?t.cloneDeep(o):o}return arguments.length>1?n:null},n.prototype.hasData=function(t){return this.data.hasOwnProperty(t)},n.prototype.connect=function(t){if(!(t instanceof n))throw new Error("Target store isn't an instance of Store");var e=t.getStoreKey();return!this.stores.hasOwnProperty(e)&&(this.stores[e]=t,this.emitEvent("connect_store",e,t),!0)},n});
//# sourceMappingURL=store.min.js.map
